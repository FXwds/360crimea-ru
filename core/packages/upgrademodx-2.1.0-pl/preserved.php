<?php return array (
  'c2e184a7ec16371d31f268b691570d6e' => 
  array (
    'criteria' => 
    array (
      'name' => 'upgrademodx',
    ),
    'object' => 
    array (
      'name' => 'upgrademodx',
      'path' => '{core_path}components/upgrademodx/',
      'assets_path' => '{assets_path}components/upgrademodx/',
    ),
  ),
  '3df0020aae47c8175db1b2bdcf3d146a' => 
  array (
    'criteria' => 
    array (
      'key' => 'ugm_versionlist_api_url',
    ),
    'object' => 
    array (
      'key' => 'ugm_versionlist_api_url',
      'value' => '//api.github.com/repos/modxcms/revolution/tags',
      'xtype' => 'textfield',
      'namespace' => 'upgrademodx',
      'area' => 'Widget',
      'editedon' => NULL,
    ),
  ),
  '2a337190342853a1ee626413c5d1936f' => 
  array (
    'criteria' => 
    array (
      'key' => 'ugm_temp_dir',
    ),
    'object' => 
    array (
      'key' => 'ugm_temp_dir',
      'value' => '{base_path}ugmtemp/',
      'xtype' => 'textfield',
      'namespace' => 'upgrademodx',
      'area' => 'Widget',
      'editedon' => NULL,
    ),
  ),
  'f37732ead70ef849353b907ea99b3a92' => 
  array (
    'criteria' => 
    array (
      'key' => 'ugm_cert_path',
    ),
    'object' => 
    array (
      'key' => 'ugm_cert_path',
      'value' => '',
      'xtype' => 'textfield',
      'namespace' => 'upgrademodx',
      'area' => 'GitHub',
      'editedon' => NULL,
    ),
  ),
  '7f827f8331e8c987c82e87bc1be75101' => 
  array (
    'criteria' => 
    array (
      'key' => 'ugm_file_version',
    ),
    'object' => 
    array (
      'key' => 'ugm_file_version',
      'value' => '2.7.0-pl',
      'xtype' => 'textfield',
      'namespace' => 'upgrademodx',
      'area' => 'Widget',
      'editedon' => '2018-11-28 15:01:32',
    ),
  ),
  'dda7e2fb5eb605b2f4cba69e5d1d3006' => 
  array (
    'criteria' => 
    array (
      'key' => 'ugm_force_pcl_zip',
    ),
    'object' => 
    array (
      'key' => 'ugm_force_pcl_zip',
      'value' => '0',
      'xtype' => 'combo-boolean',
      'namespace' => 'upgrademodx',
      'area' => 'Download',
      'editedon' => NULL,
    ),
  ),
  '4283d942cdb9ae18e9aafce10d3ffdd7' => 
  array (
    'criteria' => 
    array (
      'key' => 'ugm_modx_timeout',
    ),
    'object' => 
    array (
      'key' => 'ugm_modx_timeout',
      'value' => '6',
      'xtype' => 'textfield',
      'namespace' => 'upgrademodx',
      'area' => 'Download',
      'editedon' => NULL,
    ),
  ),
  'eeab7c48db9e5347476f041b0bb9c229' => 
  array (
    'criteria' => 
    array (
      'key' => 'ugm_ssl_verify_peer',
    ),
    'object' => 
    array (
      'key' => 'ugm_ssl_verify_peer',
      'value' => '1',
      'xtype' => 'combo-boolean',
      'namespace' => 'upgrademodx',
      'area' => 'Download',
      'editedon' => NULL,
    ),
  ),
  '51548dfdcd67a0fbe95433ef6bb3e61f' => 
  array (
    'criteria' => 
    array (
      'key' => 'ugm_language',
    ),
    'object' => 
    array (
      'key' => 'ugm_language',
      'value' => 'en',
      'xtype' => 'textfield',
      'namespace' => 'upgrademodx',
      'area' => 'Form',
      'editedon' => NULL,
    ),
  ),
  '75fa50a9742a72644d80bfbe917b5bc0' => 
  array (
    'criteria' => 
    array (
      'key' => 'ugm_pl_only',
    ),
    'object' => 
    array (
      'key' => 'ugm_pl_only',
      'value' => '1',
      'xtype' => 'combo-boolean',
      'namespace' => 'upgrademodx',
      'area' => 'Form',
      'editedon' => NULL,
    ),
  ),
  'f97686b87fe47f1fb02acde4e08160a6' => 
  array (
    'criteria' => 
    array (
      'key' => 'ugm_github_username',
    ),
    'object' => 
    array (
      'key' => 'ugm_github_username',
      'value' => '',
      'xtype' => 'textfield',
      'namespace' => 'upgrademodx',
      'area' => 'GitHub',
      'editedon' => NULL,
    ),
  ),
  '3aaa31aee7361804f448f4dafbc30639' => 
  array (
    'criteria' => 
    array (
      'key' => 'ugm_github_token',
    ),
    'object' => 
    array (
      'key' => 'ugm_github_token',
      'value' => '',
      'xtype' => 'textfield',
      'namespace' => 'upgrademodx',
      'area' => 'GitHub',
      'editedon' => NULL,
    ),
  ),
  'f7737407f7d558e8d4627af1f81403d1' => 
  array (
    'criteria' => 
    array (
      'key' => 'ugm_github_timeout',
    ),
    'object' => 
    array (
      'key' => 'ugm_github_timeout',
      'value' => '6',
      'xtype' => 'textfield',
      'namespace' => 'upgrademodx',
      'area' => 'GitHub',
      'editedon' => NULL,
    ),
  ),
  '756a4c94ff40d973ea0e1cff785ab545' => 
  array (
    'criteria' => 
    array (
      'key' => 'ugm_versions_to_show',
    ),
    'object' => 
    array (
      'key' => 'ugm_versions_to_show',
      'value' => '5',
      'xtype' => 'textfield',
      'namespace' => 'upgrademodx',
      'area' => 'Form',
      'editedon' => NULL,
    ),
  ),
  '7975534b1767d6e3f5f2575df4806494' => 
  array (
    'criteria' => 
    array (
      'key' => 'ugm_groups',
    ),
    'object' => 
    array (
      'key' => 'ugm_groups',
      'value' => 'Administrator',
      'xtype' => 'textfield',
      'namespace' => 'upgrademodx',
      'area' => 'Security',
      'editedon' => NULL,
    ),
  ),
  'a35e45a4d89856ffd458cde0b2ad6575' => 
  array (
    'criteria' => 
    array (
      'key' => 'ugm_interval',
    ),
    'object' => 
    array (
      'key' => 'ugm_interval',
      'value' => '1 day',
      'xtype' => 'textfield',
      'namespace' => 'upgrademodx',
      'area' => 'Widget',
      'editedon' => NULL,
    ),
  ),
  '61a2fc63cccc725ccde014d1ffb41aea' => 
  array (
    'criteria' => 
    array (
      'key' => 'ugm_last_check',
    ),
    'object' => 
    array (
      'key' => 'ugm_last_check',
      'value' => '2018-12-14 18:03:58',
      'xtype' => 'textfield',
      'namespace' => 'upgrademodx',
      'area' => 'Widget',
      'editedon' => '2018-12-14 18:03:58',
    ),
  ),
  '1d94b39ea76f1636aa720aaa8970f24f' => 
  array (
    'criteria' => 
    array (
      'key' => 'ugm_latest_version',
    ),
    'object' => 
    array (
      'key' => 'ugm_latest_version',
      'value' => '2.7.0-pl',
      'xtype' => 'textfield',
      'namespace' => 'upgrademodx',
      'area' => 'Widget',
      'editedon' => '2018-11-28 15:00:26',
    ),
  ),
  '3176f2864335c899646ec8e56745f958' => 
  array (
    'criteria' => 
    array (
      'key' => 'ugm_hide_when_no_upgrade',
    ),
    'object' => 
    array (
      'key' => 'ugm_hide_when_no_upgrade',
      'value' => '0',
      'xtype' => 'combo-boolean',
      'namespace' => 'upgrademodx',
      'area' => 'Widget',
      'editedon' => NULL,
    ),
  ),
  '66c4e7350ac6964a41d283a4531cb705' => 
  array (
    'criteria' => 
    array (
      'key' => 'ugm_version_list_path',
    ),
    'object' => 
    array (
      'key' => 'ugm_version_list_path',
      'value' => '{core_path}cache/upgrademodx/',
      'xtype' => 'textfield',
      'namespace' => 'upgrademodx',
      'area' => 'Widget',
      'editedon' => NULL,
    ),
  ),
  '2a4d67df591f2248bbee98a50f2d1736' => 
  array (
    'criteria' => 
    array (
      'name' => 'Upgrade MODX',
    ),
    'object' => 
    array (
      'id' => 7,
      'name' => 'Upgrade MODX',
      'description' => 'Upgrade MODX Widget',
      'type' => 'snippet',
      'content' => 'UpgradeMODXWidget',
      'namespace' => 'upgrademodx',
      'lexicon' => 'upgrademodx:default',
      'size' => 'half',
      'name_trans' => 'Upgrade MODX',
      'description_trans' => 'Upgrade MODX Widget',
    ),
  ),
  '9f40e451dd24fb0b4ea9a8603e0f75b4' => 
  array (
    'criteria' => 
    array (
      'category' => 'UpgradeMODX',
    ),
    'object' => 
    array (
      'id' => 8,
      'parent' => 0,
      'category' => 'UpgradeMODX',
      'rank' => 0,
    ),
  ),
  'b44ab65512256ff0a38b144caaca6723' => 
  array (
    'criteria' => 
    array (
      'name' => 'UpgradeMODXTpl',
    ),
    'object' => 
    array (
      'id' => 8,
      'source' => 0,
      'property_preprocess' => 0,
      'name' => 'UpgradeMODXTpl',
      'description' => 'Tpl chunk for alert widget',
      'editor_type' => 0,
      'category' => 8,
      'cache_type' => 0,
      'snippet' => '<div id="Upgrade_modx">
    <h3 style="color:[[+ugm_notice_color]]">[[+ugm_notice]]</h3>
    <br/>[[+ugm_current_version_caption]]: [[+ugm_current_version]]
    <br/>[[+ugm_latest_version_caption]]: [[+ugm_latest_version]]



    [[+ugm_version_form]]
    <div id="ugm_errors">[[+ugm_errors]]</div>
</div>
<script src="[[+ugm_assets_url]]js/classie.js"></script>
<script src="[[+ugm_assets_url]]js/progressbutton.js"></script>
<script src="[[+ugm_assets_url]]js/ugm-bottom.js"></script>
<p>&nbsp;</p>


',
      'locked' => 0,
      'properties' => 'a:0:{}',
      'static' => 0,
      'static_file' => '',
      'content' => '<div id="Upgrade_modx">
    <h3 style="color:[[+ugm_notice_color]]">[[+ugm_notice]]</h3>
    <br/>[[+ugm_current_version_caption]]: [[+ugm_current_version]]
    <br/>[[+ugm_latest_version_caption]]: [[+ugm_latest_version]]



    [[+ugm_version_form]]
    <div id="ugm_errors">[[+ugm_errors]]</div>
</div>
<script src="[[+ugm_assets_url]]js/classie.js"></script>
<script src="[[+ugm_assets_url]]js/progressbutton.js"></script>
<script src="[[+ugm_assets_url]]js/ugm-bottom.js"></script>
<p>&nbsp;</p>


',
    ),
  ),
  '8a3c2404688dd4ff050a8a4f5a3cef24' => 
  array (
    'criteria' => 
    array (
      'name' => 'UpgradeMODXWidget',
    ),
    'object' => 
    array (
      'id' => 30,
      'source' => 0,
      'property_preprocess' => 0,
      'name' => 'UpgradeMODXWidget',
      'description' => 'Upgrade MODX Dashboard widget',
      'editor_type' => 0,
      'category' => 8,
      'cache_type' => 0,
      'snippet' => '/**
 * UpgradeMODXWidget snippet for UpgradeMODX extra
 *
 * Copyright 2015-2018 Bob Ray <https://bobsguides.com>
 * Created on 08-16-2015
 *
 * UpgradeMODX is free software; you can redistribute it and/or modify it under the
 * terms of the GNU General Public License as published by the Free Software
 * Foundation; either version 2 of the License, or (at your option) any later
 * version.
 *
 * UpgradeMODX is distributed in the hope that it will be useful, but WITHOUT ANY
 * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR
 * A PARTICULAR PURPOSE. See the GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along with
 * UpgradeMODX; if not, write to the Free Software Foundation, Inc., 59 Temple
 * Place, Suite 330, Boston, MA 02111-1307 USA
 *
 * @package upgrademodx
 */

/**
 * Description
 * -----------
 * UpgradeMODX Dashboard widget
 * This package was inspired by the work of a number of people and I have borrowed some of their code.
 * Dmytro Lukianenko (dmi3yy) is the original author of the MODX install script. Susan Sottwell, Sharapov,
 * Bumkaka, Inreti, Zaigham Rana, frischnetz, and AgelxNash, also contributed and I\'d like to thank all
 * of them for laying the groundwork.
 *
 * Variables
 * ---------
 * @var $modx modX
 * @var $scriptProperties array
 *
 * @package upgrademodx
 **/

/* Properties

 * @property &groups textfield -- group, or commma-separated list of groups, who will see the widget; Default: (empty)..
 * @property &hideWhenNoUpgrade combo-boolean -- Hide widget when no upgrade is available; Default: No.
 * @property &interval textfield -- Interval between checks -- Examples: 1 week, 3 days, 6 hours; Default: 1 week.
 * @property &language textfield -- Two-letter code of language to user; Default: en.
 * @property &lastCheck textfield -- Date and time of last check -- set automatically; Default: (empty)..
 * @property &latestVersion textfield -- Latest version (at last check) -- set automatically; Default: (empty)..
 * @property &plOnly combo-boolean -- Show only pl (stable) versions; Default: yes.
 * @property &versionsToShow textfield -- Number of versions to show in upgrade form (not widget); Default: 5.

 */

if (php_sapi_name() === \'cli\') {
    /* This section for debugging during development. It won\'t execute in MODX */
/*    include \'C:\\xampp\\htdocs\\addons\\assets\\mycomponents\\instantiatemodx\\instantiatemodx.php\';
    $snippet =
    $scriptProperties = array(
        \'versionsToShow\' => 5,
        \'hideWhenNoUpgrade\' => false,
        \'lastCheck\' => \'\',
        \'interval\' => \'+60 seconds\',
        \'plOnly\' => false,
        \'language\' => \'en\',
        \'forcePclZip\' => false,
        \'currentVersion\' => $modx->getOption(\'settings_version\'),
        \'latestVersion\' => \'2.4.3-pl\',
        \'githubTimeout\' => 6,
        \'modxTimeout\' => 6,
    );*/

}

/* Initialize */
/* This will execute when in MODX */
$language = $modx->getOption(\'ugm_language\', null, $modx->getOption(\'manager_language\'), true);
$language = empty($language) ? \'en\' : $language;
$props = $scriptProperties;
$modx->lexicon->load($language . \':upgrademodx:default\');
/* Return empty string if user shouldn\'t see widget */
$devMode = $modx->getOption(\'ugm.devMode\', null, false, true);
$groups = $modx->getOption(\'ugm_groups\', null, \'Administrator\', true);

if (strpos($groups, \',\') !== false) {
    $groups = explode(\',\', $groups);
}
if (! $modx->user->isMember($groups)) {
    return \'\';
}

$corePath = $modx->getOption(\'ugm.core_path\', null, $modx->getOption(\'core_path\', null, MODX_CORE_PATH) . \'components/upgrademodx/\');
$assetsUrl = $modx->getOption(\'ugm.assets_url\', null, $modx->getOption(\'assets_url\', null, MODX_ASSETS_URL) . \'components/upgrademodx/\');
require_once($corePath . \'model/upgrademodx/upgrademodx.class.php\');
$upgrade = new UpgradeMODX($modx);
$upgrade->init($props);
$props[\'ugm_setup_url\'] = MODX_SITE_URL . \'setup/index.php\';
unset($props[\'controller\']); // remove trash from scriptProperties
$modx->regClientStartupScript(\'<script>
var ugmConnectorUrl = "\' . $assetsUrl . \'connector.php";
var ugm_config = \' . $modx->toJSON($props)  . \';
var ugm_setup_url = "\' . MODX_SITE_URL . \'setup/index.php";
</script>\'
);
$modx->regClientCSS($assetsUrl . \'css/progress.css\');
$modx->regClientStartupScript("//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js");
$modx->regClientStartupScript($assetsUrl . \'js/modernizr.custom.js\');
$lastCheck = $modx->getOption(\'ugm_last_check\', null, \'2015-08-17 00:00:004\', true);
$interval = $modx->getOption(\'ugm_interval\', null, \'+1 day\', true);
$hideWhenNoUpgrade = $modx->getOption(\'ugm_hide_when_no_upgrade\', null, false, true);
$plOnly = $modx->getOption(\'ugm_pl_only\', null, true, true);
$versionsToShow = $modx->getOption(\'ugm_versions_to_show\', null, 5, true);
$settingsVersion = $modx->getOption(\'settings_version\');
$latestVersion = $modx->getOption(\'ugm_latest_version\', null, \'\', true);
/* $fileVersion is current version at time of last versionlist creation */
$fileVersion = $modx->getOption(\'ugm_file_version\', null, \'\', true);
$regenerate = false;
if ($fileVersion !== $settingsVersion) {
    $regenerate = true;
}

/* Set Placeholders */
$placeholders = array();
$placeholders[\'[[+ugm_assets_url]]\'] = $assetsUrl;
$placeholders[\'[[+ugm_current_version]]\'] = $settingsVersion;
$placeholders[\'[[+ugm_current_version_caption]]\'] = $modx->lexicon(\'ugm_current_version_caption\');
$placeholders[\'[[+ugm_latest_version_caption]]\'] = $modx->lexicon(\'ugm_latest_version_caption\');

$versionListExists = $upgrade->versionListExists();

$timeToCheck = $upgrade->timeToCheck($lastCheck, $interval);

/* Perform check if no latestVersion, or if it\'s time to check, or settings_version has been changed */
if ((!$versionListExists ) || $timeToCheck || empty($latestVersion) || $regenerate) {
    $upgradeAvailable = $upgrade->upgradeAvailable($settingsVersion);
    $latestVersion = $upgrade->getLatestVersion();
} else {
    $upgradeAvailable = version_compare($settingsVersion, $latestVersion) < 0;
}

$placeholders[\'[[+ugm_latest_version]]\'] = $latestVersion;

if ($devMode) {
    $upgradeAvailable = true;
}

if ($upgradeAvailable) {
    $versionForm = $upgrade->createVersionForm($modx);
}

$errors = $upgrade->getErrors();

if (!empty($errors)) {
    $msg = \'\';
    foreach ($errors as $error) {
        $msg .= \'<br/><span style="color:red">\' . $modx->lexicon(\'ugm_error\') .
            \': \' . $error . \'</span>\';
    }

    return $msg;
}

/* Process */

/* See if there\'s a new version */
if ($upgradeAvailable) {
    $placeholders[\'[[+ugm_notice]]\'] = $modx->lexicon(\'ugm_upgrade_available\');
    $placeholders[\'[[+ugm_notice_color]]\'] = \'green\';
    $placeholders[\'[[+ugm_version_form]]\'] = $versionForm;
} else {
    if ($hideWhenNoUpgrade) {
        return \'\';
    } else {
        $placeholders[\'[[+ugm_notice]]\'] = $modx->lexicon(\'ugm_modx_up_to_date\');
        $placeholders[\'[[+ugm_notice_color]]\'] = \'gray\';
    }
}
/* Get Tpl */
$tpl = $modx->getChunk(\'UpgradeMODXTpl\');

/* Do the replacements */
$tpl = str_replace(array_keys($placeholders), array_values($placeholders), $tpl);

/*if (php_sapi_name() === \'cli\') {
    echo $tpl;
}*/

return $tpl;',
      'locked' => 0,
      'properties' => 'a:0:{}',
      'moduleguid' => '',
      'static' => 0,
      'static_file' => '',
      'content' => '/**
 * UpgradeMODXWidget snippet for UpgradeMODX extra
 *
 * Copyright 2015-2018 Bob Ray <https://bobsguides.com>
 * Created on 08-16-2015
 *
 * UpgradeMODX is free software; you can redistribute it and/or modify it under the
 * terms of the GNU General Public License as published by the Free Software
 * Foundation; either version 2 of the License, or (at your option) any later
 * version.
 *
 * UpgradeMODX is distributed in the hope that it will be useful, but WITHOUT ANY
 * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR
 * A PARTICULAR PURPOSE. See the GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along with
 * UpgradeMODX; if not, write to the Free Software Foundation, Inc., 59 Temple
 * Place, Suite 330, Boston, MA 02111-1307 USA
 *
 * @package upgrademodx
 */

/**
 * Description
 * -----------
 * UpgradeMODX Dashboard widget
 * This package was inspired by the work of a number of people and I have borrowed some of their code.
 * Dmytro Lukianenko (dmi3yy) is the original author of the MODX install script. Susan Sottwell, Sharapov,
 * Bumkaka, Inreti, Zaigham Rana, frischnetz, and AgelxNash, also contributed and I\'d like to thank all
 * of them for laying the groundwork.
 *
 * Variables
 * ---------
 * @var $modx modX
 * @var $scriptProperties array
 *
 * @package upgrademodx
 **/

/* Properties

 * @property &groups textfield -- group, or commma-separated list of groups, who will see the widget; Default: (empty)..
 * @property &hideWhenNoUpgrade combo-boolean -- Hide widget when no upgrade is available; Default: No.
 * @property &interval textfield -- Interval between checks -- Examples: 1 week, 3 days, 6 hours; Default: 1 week.
 * @property &language textfield -- Two-letter code of language to user; Default: en.
 * @property &lastCheck textfield -- Date and time of last check -- set automatically; Default: (empty)..
 * @property &latestVersion textfield -- Latest version (at last check) -- set automatically; Default: (empty)..
 * @property &plOnly combo-boolean -- Show only pl (stable) versions; Default: yes.
 * @property &versionsToShow textfield -- Number of versions to show in upgrade form (not widget); Default: 5.

 */

if (php_sapi_name() === \'cli\') {
    /* This section for debugging during development. It won\'t execute in MODX */
/*    include \'C:\\xampp\\htdocs\\addons\\assets\\mycomponents\\instantiatemodx\\instantiatemodx.php\';
    $snippet =
    $scriptProperties = array(
        \'versionsToShow\' => 5,
        \'hideWhenNoUpgrade\' => false,
        \'lastCheck\' => \'\',
        \'interval\' => \'+60 seconds\',
        \'plOnly\' => false,
        \'language\' => \'en\',
        \'forcePclZip\' => false,
        \'currentVersion\' => $modx->getOption(\'settings_version\'),
        \'latestVersion\' => \'2.4.3-pl\',
        \'githubTimeout\' => 6,
        \'modxTimeout\' => 6,
    );*/

}

/* Initialize */
/* This will execute when in MODX */
$language = $modx->getOption(\'ugm_language\', null, $modx->getOption(\'manager_language\'), true);
$language = empty($language) ? \'en\' : $language;
$props = $scriptProperties;
$modx->lexicon->load($language . \':upgrademodx:default\');
/* Return empty string if user shouldn\'t see widget */
$devMode = $modx->getOption(\'ugm.devMode\', null, false, true);
$groups = $modx->getOption(\'ugm_groups\', null, \'Administrator\', true);

if (strpos($groups, \',\') !== false) {
    $groups = explode(\',\', $groups);
}
if (! $modx->user->isMember($groups)) {
    return \'\';
}

$corePath = $modx->getOption(\'ugm.core_path\', null, $modx->getOption(\'core_path\', null, MODX_CORE_PATH) . \'components/upgrademodx/\');
$assetsUrl = $modx->getOption(\'ugm.assets_url\', null, $modx->getOption(\'assets_url\', null, MODX_ASSETS_URL) . \'components/upgrademodx/\');
require_once($corePath . \'model/upgrademodx/upgrademodx.class.php\');
$upgrade = new UpgradeMODX($modx);
$upgrade->init($props);
$props[\'ugm_setup_url\'] = MODX_SITE_URL . \'setup/index.php\';
unset($props[\'controller\']); // remove trash from scriptProperties
$modx->regClientStartupScript(\'<script>
var ugmConnectorUrl = "\' . $assetsUrl . \'connector.php";
var ugm_config = \' . $modx->toJSON($props)  . \';
var ugm_setup_url = "\' . MODX_SITE_URL . \'setup/index.php";
</script>\'
);
$modx->regClientCSS($assetsUrl . \'css/progress.css\');
$modx->regClientStartupScript("//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js");
$modx->regClientStartupScript($assetsUrl . \'js/modernizr.custom.js\');
$lastCheck = $modx->getOption(\'ugm_last_check\', null, \'2015-08-17 00:00:004\', true);
$interval = $modx->getOption(\'ugm_interval\', null, \'+1 day\', true);
$hideWhenNoUpgrade = $modx->getOption(\'ugm_hide_when_no_upgrade\', null, false, true);
$plOnly = $modx->getOption(\'ugm_pl_only\', null, true, true);
$versionsToShow = $modx->getOption(\'ugm_versions_to_show\', null, 5, true);
$settingsVersion = $modx->getOption(\'settings_version\');
$latestVersion = $modx->getOption(\'ugm_latest_version\', null, \'\', true);
/* $fileVersion is current version at time of last versionlist creation */
$fileVersion = $modx->getOption(\'ugm_file_version\', null, \'\', true);
$regenerate = false;
if ($fileVersion !== $settingsVersion) {
    $regenerate = true;
}

/* Set Placeholders */
$placeholders = array();
$placeholders[\'[[+ugm_assets_url]]\'] = $assetsUrl;
$placeholders[\'[[+ugm_current_version]]\'] = $settingsVersion;
$placeholders[\'[[+ugm_current_version_caption]]\'] = $modx->lexicon(\'ugm_current_version_caption\');
$placeholders[\'[[+ugm_latest_version_caption]]\'] = $modx->lexicon(\'ugm_latest_version_caption\');

$versionListExists = $upgrade->versionListExists();

$timeToCheck = $upgrade->timeToCheck($lastCheck, $interval);

/* Perform check if no latestVersion, or if it\'s time to check, or settings_version has been changed */
if ((!$versionListExists ) || $timeToCheck || empty($latestVersion) || $regenerate) {
    $upgradeAvailable = $upgrade->upgradeAvailable($settingsVersion);
    $latestVersion = $upgrade->getLatestVersion();
} else {
    $upgradeAvailable = version_compare($settingsVersion, $latestVersion) < 0;
}

$placeholders[\'[[+ugm_latest_version]]\'] = $latestVersion;

if ($devMode) {
    $upgradeAvailable = true;
}

if ($upgradeAvailable) {
    $versionForm = $upgrade->createVersionForm($modx);
}

$errors = $upgrade->getErrors();

if (!empty($errors)) {
    $msg = \'\';
    foreach ($errors as $error) {
        $msg .= \'<br/><span style="color:red">\' . $modx->lexicon(\'ugm_error\') .
            \': \' . $error . \'</span>\';
    }

    return $msg;
}

/* Process */

/* See if there\'s a new version */
if ($upgradeAvailable) {
    $placeholders[\'[[+ugm_notice]]\'] = $modx->lexicon(\'ugm_upgrade_available\');
    $placeholders[\'[[+ugm_notice_color]]\'] = \'green\';
    $placeholders[\'[[+ugm_version_form]]\'] = $versionForm;
} else {
    if ($hideWhenNoUpgrade) {
        return \'\';
    } else {
        $placeholders[\'[[+ugm_notice]]\'] = $modx->lexicon(\'ugm_modx_up_to_date\');
        $placeholders[\'[[+ugm_notice_color]]\'] = \'gray\';
    }
}
/* Get Tpl */
$tpl = $modx->getChunk(\'UpgradeMODXTpl\');

/* Do the replacements */
$tpl = str_replace(array_keys($placeholders), array_values($placeholders), $tpl);

/*if (php_sapi_name() === \'cli\') {
    echo $tpl;
}*/

return $tpl;',
    ),
  ),
);